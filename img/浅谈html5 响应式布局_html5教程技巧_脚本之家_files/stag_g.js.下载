var thisPage={cWidth:config.rsi0,cHeight:config.rsi1,minBlockHeight:25,minBlockWidth:100,blockBorderWidth:2,block1Scale:7,block2Scale:7,ranknum:0,rankflag:false,oneRowCol:false,flag:false,autoflag:true,lunboTimer:0,lunboTime:2000,lunboIndex:0,iconArray:null,currentHLElement:null,initialize:function(){var a=this.calCellSize();this.rowNum=a.rowNum;this.colNum=a.colNum;this.blockHeight=Math.floor(this.cHeight/this.rowNum)-this.blockBorderWidth;this.blockWidth=Math.floor(this.cWidth/this.colNum)-this.blockBorderWidth;this.blockArr=new Array();this.blockObj={block1:{initNum:Math.round(this.rowNum*this.colNum/this.block1Scale),readerNum:0},block2:{initNum:Math.round(this.rowNum*this.colNum/this.block2Scale),readerNum:0}};if(this.rowNum*this.colNum<20){this.blockBorderWidth=1}if(this.colNum<2){this.blockObj.block1.initNum=0}if(this.rowNum<2){this.blockObj.block1.initNum=this.blockObj.block2.initNum=0}if(this.rowNum===1||this.colNum===1){this.blockObj.block1.initNum=this.blockObj.block2.initNum=0;if(this.colNum===1){this.rankflag=true}this.oneRowCol=true}this.iteBCA=config.iteBCA.split(",");this.adContainer=document.getElementById("container");this.adContainer.style.width=config.rsi0+"px";this.adContainer.style.height=config.rsi1+"px"},calCellSize:function(){var n={};var c=Math.floor(this.cHeight/this.minBlockHeight);var g=Math.floor(this.cWidth/this.minBlockWidth);var i=c*g;var e=Math.floor(c/2);var d=Math.floor(g/2);var b=Math.floor(e*d/2);var m=Math.ceil(e*g/4);var j=((2*2-1)*b+(2*1-1)*m)/i;var f=b+m+i-b*4-m*2;if(f>ads.length){f=ads.length-2}var a=f/(1-j);if(a<i){var h=Math.sqrt(a/i);c=Math.floor(this.cHeight*h/this.minBlockHeight);g=Math.floor(this.cWidth*h/this.minBlockWidth)}if(this.cHeight<this.minBlockHeight*2){c=1;g=Math.min(ads.length,Math.floor(this.cWidth/this.minBlockWidth))}else{if(this.cWidth<this.minBlockWidth*2){c=Math.min(ads.length,Math.floor(this.cHeight/this.minBlockHeight));g=1}}n.rowNum=Math.max(1,c);n.colNum=Math.max(1,g);return n},render:function(){this.initialize();var b=0;this.iconArray=new Array();for(k=0,l=ads.length;k<l;k++){this.flag=false;var a=document.createElement("a");this.ranknum=k+1;a.innerHTML=ads[k].title;a.href=ads[k].curl;a.target="_blank";if(this.blockObj.block1.readerNum!=this.blockObj.block1.initNum){this.blockObj.block1.readerNum++;this.reanderAd(this.renderBlock1,1,1,a)}else{if(this.blockObj.block2.readerNum!=this.blockObj.block2.initNum){this.blockObj.block2.readerNum++;this.reanderAd(this.renderBlock2,1,0,a)}else{this.reanderAd(this.renderBlock3,0,0,a)}}if(this.flag&&b<3){this.iconArray.push(a);b+=1}}this.initEvents();this.autoPlay();this.sendGoogleClick()},nextLuwords:function(){var a=this.iconArray[this.lunboIndex];if(this.currentHLElement){this.setNormal(this.currentHLElement)}this.setHover(a);this.currentHLElement=a;if(this.lunboIndex==this.iconArray.length-1){this.lunboIndex=0}else{this.lunboIndex=this.lunboIndex+1}},autoPlay:function(){return;if(!this.autoflag){return}if(this.iconArray.length==0){return}this.lunboTimer=setInterval(function(){thisPage.nextLuwords()},this.lunboTime)},reanderAd:function(f,b,e,d){for(var c=0;c<300;c++){if(this.oneRowCol){c=300;break}var a=Math.floor(Math.random()*(this.rowNum-b));var g=Math.floor(Math.random()*(this.colNum-e));if(f(a,g,d)){break}}if(c==300){for(var a=0;a<this.rowNum-this.blockNeedRowNum;a++){for(var g=0;g<this.colNum-this.blockNeedColNum;g++){if(f(a,g,d)){a=this.rowNum;break}}}}if(!this.flag){for(var a=0;a<this.rowNum;a++){for(var g=0;g<this.colNum;g++){if(this.renderBlock3(a,g,d)){a=this.rowNum;break}}}}},renderBlock1:function(a,d,b){thisPage.blockArr[a]=thisPage.blockArr[a]||[];thisPage.blockArr[a+1]=thisPage.blockArr[a+1]||[];thisPage.blockArr[a+2]=thisPage.blockArr[a+2]||[];thisPage.blockArr[a+3]=thisPage.blockArr[a+3]||[];thisPage.blockArr[a-1]=thisPage.blockArr[a-1]||[];thisPage.blockArr[a-2]=thisPage.blockArr[a-2]||[];if((thisPage.blockArr[a-1][d]=="block1"&&thisPage.blockArr[a-1][d+1]=="block1"&&thisPage.blockArr[a-2][d]=="block1"&&thisPage.blockArr[a-2][d+1]=="block1")||(thisPage.blockArr[a+2][d]=="block1"&&thisPage.blockArr[a+2][d+1]=="block1"&&thisPage.blockArr[a+3][d]=="block1"&&thisPage.blockArr[a+3][d+1]=="block1")||(thisPage.blockArr[a][d+2]=="block1"&&thisPage.blockArr[a][d+3]=="block1"&&thisPage.blockArr[a+1][d+2]=="block1"&&thisPage.blockArr[a+1][d+3]=="block1")||(thisPage.blockArr[a][d-1]=="block1"&&thisPage.blockArr[a][d-2]=="block1"&&thisPage.blockArr[a+1][d-1]=="block1"&&thisPage.blockArr[a+1][d-2]=="block1")){return false}if(!thisPage.blockArr[a][d]&&!thisPage.blockArr[a][d+1]){if(!thisPage.blockArr[a+1][d]&&!thisPage.blockArr[a+1][d+1]){thisPage.blockArr[a][d]=thisPage.blockArr[a][d+1]=thisPage.blockArr[a+1][d]=thisPage.blockArr[a+1][d+1]="block1";b.className="block1";var c=Math.floor(Math.random()*1);thisPage.addAdStyle(a,d,2,2,b,c);thisPage.flag=true;return true}}return false},renderBlock2:function(a,e,c){thisPage.blockArr[a]=thisPage.blockArr[a]||[];thisPage.blockArr[a+1]=thisPage.blockArr[a+1]||[];thisPage.blockArr[a+2]=thisPage.blockArr[a+2]||[];thisPage.blockArr[a+3]=thisPage.blockArr[a+3]||[];thisPage.blockArr[a-1]=thisPage.blockArr[a-1]||[];thisPage.blockArr[a-2]=thisPage.blockArr[a-2]||[];if(!thisPage.blockArr[a][e]&&!thisPage.blockArr[a+1][e]){thisPage.blockArr[a][e]=thisPage.blockArr[a+1][e]="block2";var b=Math.ceil(c.innerHTML.replace(/[^\x00-\xff]/g,"ci").length/2);c.className="block2 block2_"+b;var d=1;thisPage.addAdStyle(a,e,2,1,c,d);thisPage.flag=true;return true}return false},renderBlock3:function(a,d,b){thisPage.blockArr[a]=thisPage.blockArr[a]||[];if(!thisPage.blockArr[a][d]){thisPage.blockArr[a][d]=1;b.className="block3";var c=3;thisPage.addAdStyle(a,d,1,1,b,c);thisPage.flag=true;return true}return false},drawTriangle:function(f,d){var c=this.ranknum-1;var e=document.createElement("DIV");e.style.top=f+"px";e.style.left=d+"px";var b=document.createElement("DIV");var a=document.createElement("a");a.href=ads[c].curl;a.target="_blank";a.innerHTML=this.ranknum;b.appendChild(a);b.style.top=f+3+"px";b.style.left=d+2+"px";e.className="triangle";b.className="ranktext";thisPage.adContainer.appendChild(e);thisPage.adContainer.appendChild(b)},adjustFontSize:function(b,a,c){if(2==a&&2==c){return}var d=Math.ceil(b.innerHTML.replace(/[^\x00-\xff]/g,"ci").length/2);var e=Math.floor((thisPage.blockWidth*c-10)/d);e=Math.min(thisPage.blockHeight*a*0.6,e);e=Math.min(24,e);b.style.fontSize=e+"px"},addAdStyle:function(a,g,e,c,d,f){if(d.className.indexOf("block1")>-1){d.style.fontWeight="bolder"}postop=(thisPage.blockHeight+thisPage.blockBorderWidth)*a;posleft=(thisPage.blockWidth+thisPage.blockBorderWidth)*g;d.style.top=postop+"px";d.style.left=posleft+"px";d.style.height=d.style.lineHeight=thisPage.blockHeight*e+thisPage.blockBorderWidth*(e-1)+"px";d.style.width=thisPage.blockWidth*c+thisPage.blockBorderWidth*(c-1)+"px";var b=thisPage.iteBCA[f];d.style.backgroundColor=b;thisPage.adContainer.appendChild(d);if(a+(e-1)==(thisPage.rowNum-1)){d.style.height=d.style.lineHeight=thisPage.cHeight-(thisPage.blockHeight+thisPage.blockBorderWidth)*a+"px"}if(g+(c-1)==(thisPage.colNum-1)){d.style.width=thisPage.cWidth-(thisPage.blockWidth+thisPage.blockBorderWidth)*g+"px"}if(this.rankflag&&this.ranknum<5){this.drawTriangle(postop,posleft)}if(!this.oneRowCol){this.adjustFontSize(d,e,c)}},setHover:function(b){var a=b.style.backgroundColor;b.style.backgroundColor="#fff";b.style.borderColor=a;b.style.color="#000";b.style.height=b.style.lineHeight=parseInt(b.style.height)-6+"px";b.style.width=parseInt(b.style.width)-6+"px";b.style.top=parseInt(b.style.top)+1+"px";b.style.left=parseInt(b.style.left)+1+"px";b.style.borderWidth=2+"px";b.style.borderStyle="solid"},setNormal:function(b){var a=b.style.borderColor;b.style.backgroundColor=a;b.style.color="#000";b.style.height=b.style.lineHeight=parseInt(b.style.height)+6+"px";b.style.width=parseInt(b.style.width)+6+"px";b.style.top=parseInt(b.style.top)-1+"px";b.style.left=parseInt(b.style.left)-1+"px";b.style.borderWidth=0+"px"},initEvents:function(){var a=document.getElementById("container");var b=this;a.onmouseover=function(j){if(thisPage.autoflag){clearInterval(thisPage.lunboTimer)}j=j||window.event;var i=j.target||j.srcElement;var g;g=i;var h=false;var d;while(g){var f=g.className||"";if(f.indexOf("block")!==-1){break}g=g.parentNode}if(g&&g.className.indexOf("block")!==-1){h=true}d=g;if(!h){return}var c=b.currentHLElement;if(c===d){return}if(c){thisPage.setNormal(c)}b.currentHLElement=d;thisPage.setHover(d)};a.onmouseout=function(j){j=j||window.event;var i=j.target||j.srcElement;var d=j.relatedTarget||j.toElement;var h;var f=i;while(f&&f.parentNode){var g=f.className||"";if(g.indexOf("block")!==-1){break}f=f.parentNode}if(!f||!f.className||f.className.indexOf("block")===-1){thisPage.autoPlay();return}var m=false;h=d;while(h&&h!==f){h=h.parentNode}if(h===f){m=true}if(m){return}var c=f;if(c){thisPage.setNormal(c)}b.currentHLElement=null;thisPage.autoPlay()}},sendGoogleClick:function(){try{var b=document.getElementsByTagName("a");var a=b.length;for(var d=0;d<a;d++){var c=b[d];c.onclick=function(h){var g=new Image();g.src=gClickUrl;g.onload=g.onerror=function(){}}}}catch(f){}}};thisPage.render();